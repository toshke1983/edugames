<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spelling Bee Journey</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üêù</text></svg>">
    <link rel="apple-touch-icon" href="https://img.icons8.com/color/192/bee.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <style>
        :root {
            --bee-yellow: #FFD700;
            --bee-black: #333333;f
            --honey-bg: #FFF9C4;
            --correct-green: #4CAF50;
            --wrong-red: #F44336;
        }

        body {
            font-family: 'Chalkboard SE', 'Comic Sans MS', sans-serif;
            background-color: var(--honey-bg);
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 10px;
        }

        #game-container {
            max-width: 750px;
            width: 100%;
            text-align: center;
            background: white;
            padding: 25px;
            border-radius: 40px;
            box-shadow: 0 12px 0px #e0ca00;
            border: 4px solid var(--bee-black);
        }

        .lang-tabs {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .lang-btn {
            font-size: 1rem;
            padding: 8px 15px;
            cursor: pointer;
            border: 3px solid #ddd;
            border-radius: 20px;
            background: #fff;
            font-weight: bold;
        }

        .lang-btn.active {
            border-color: var(--bee-black);
            background: var(--bee-yellow);
            transform: scale(1.05);
        }

        #image-display {
            font-size: 150px;
            margin: 15px 0;
            filter: drop-shadow(0 5px 0 rgba(0,0,0,0.1));
        }

        .options-stack {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }

        .word-btn {
            width: 90%;
            max-width: 400px;
            font-size: 2.5rem;
            font-weight: bold;
            padding: 15px;
            cursor: pointer;
            border: 4px solid var(--bee-black);
            background: white;
            border-radius: 20px;
            transition: transform 0.1s;
        }

        .word-btn:active { transform: scale(0.98); }

        .first-letter {
            font-size: 1.2em;
            color: #d32f2f;
            margin-right: 1px;
        }

        .correct { background-color: var(--correct-green) !important; color: white; border-color: #1b5e20; }
        .wrong { background-color: var(--wrong-red) !important; color: white; opacity: 0.6; }

        /* Bee Trail Layout */
        #trail-container {
            width: 100%;
            max-width: 750px;
            background: #fdf5e6;
            height: 100px;
            border-radius: 50px;
            position: relative;
            margin-top: 30px;
            display: flex;
            align-items: center;
            border: 4px dashed #ffd700;
            padding: 0 20px;
            box-sizing: border-box;
        }

		#bee {
		    font-size: 50px;
		    position: absolute;
		    transition: all 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
		    z-index: 5;
		    /* This line flips the bee to face Right */
		    transform: scaleX(-1); 
		}

        .hex-step {
            flex-grow: 1;
            height: 40px;
            margin: 0 2px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><polygon points="50 1 95 25 95 75 50 99 5 75 5 25" fill="none" stroke="%23FFD700" stroke-width="5"/></svg>');
            background-repeat: no-repeat;
            background-position: center;
        }

        #goal { font-size: 60px; position: absolute; right: 10px; }

        #celebration-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.95);
            z-index: 100;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>
<body>

<div id="game-container">
    <div class="lang-tabs">
        <button class="lang-btn" id="btn-en" onclick="setLang('en')">English üá¨üáß</button>
        <button class="lang-btn" id="btn-de" onclick="setLang('de')">Deutsch üá©üá™</button>
        <button class="lang-btn" id="btn-sr" onclick="setLang('sr')">Srpski (Lat) üá∑üá∏</button>
        <button class="lang-btn" id="btn-sr-cyr" onclick="setLang('sr-cyr')">–°—Ä–ø—Å–∫–∏ (–ã–∏—Ä) üá∑üá∏</button>
    </div>

    <div id="image-display"></div>
    <div class="options-stack" id="options-container"></div>
</div>

<div id="trail-container">
    <div id="bee">üêù</div>
    <div class="hex-step"></div><div class="hex-step"></div><div class="hex-step"></div>
    <div class="hex-step"></div><div class="hex-step"></div><div class="hex-step"></div>
    <div class="hex-step"></div><div class="hex-step"></div>
    <div id="goal">üçØ</div>
</div>

<div id="celebration-overlay">
    <h1 style="font-size: 5rem; margin: 0;">üçØ YUMMY! üçØ</h1>
    <p style="font-size: 2rem;">The bee found the honey!</p>
    <button onclick="resetGame()" style="font-size: 2rem; padding: 20px 50px; cursor: pointer; border-radius: 30px; background: var(--bee-black); color: var(--bee-yellow); border: none; font-weight: bold;">Play Again</button>
</div>

<script>
    // Data with multiple distractors covering Phonetic, Umlaut, and Palatal traps
    const gameData = [
        {
            emoji: "üçé",
            en: { word: "Apple", dist: ["Aple", "Appel", "Appple"] },
            de: { word: "Apfel", dist: ["Abfel", "Apfell", "Affel"] },
            sr: { word: "Jabuka", dist: ["Jabuca", "Jabka", "Jabuuka"] }
        },
        {
            emoji: "üêª",
            en: { word: "Bear", dist: ["Bare", "Ber", "Beare"] },
            de: { word: "B√§r", dist: ["Bar", "Ber", "B√§hr"] },
            sr: { word: "Medved", dist: ["Medvet", "Medvjed", "Metved"] }
        },
        {
            emoji: "üçí",
            en: { word: "Cherry", dist: ["Chery", "Sherry", "Cherrie"] },
            de: { word: "Kirsche", dist: ["Kirche", "Kiersche", "Kirche"] },
            sr: { word: "Tre≈°nja", dist: ["Tresnja", "Tre≈°na", "Tre≈°njia"] }
        },
        {
            emoji: "üê±",
            en: { word: "Cat", dist: ["Kat", "Catt", "Catt"] },
            de: { word: "Katze", dist: ["Kaze", "Katse", "Kattze"] },
            sr: { word: "Maƒçka", dist: ["Maƒáka", "Macka", "Maƒçk"] }
        },
        {
            emoji: "üè†",
            en: { word: "House", dist: ["Hous", "Howse", "House"] },
            de: { word: "Haus", dist: ["Hauss", "Hous", "Hauz"] },
            sr: { word: "Kuƒáa", dist: ["Kuƒça", "Kuca", "Kuaƒá"] }
        },
        {
            emoji: "üçå",
            en: { word: "Banana", dist: ["Banan", "Bannana", "Bananna"] },
            de: { word: "Banane", dist: ["Banan", "Bannane", "Bananen"] },
            sr: { word: "Banana", dist: ["Bananna", "Banaana", "Banan"] }
        },
        {
            emoji: "üê∞",
            en: { word: "Rabbit", dist: ["Rabit", "Rabbet", "Rabbitt"] },
            de: { word: "Hase", dist: ["Haase", "Hasse", "Hasen"] },
            sr: { word: "Zec", dist: ["Zeec", "Zetz", "Zecc"] }
        },
        {
            emoji: "üêù",
            en: { word: "Bee", dist: ["Be", "Bea", "Beee"] },
            de: { word: "Biene", dist: ["Bine", "Bihne", "Bienen"] },
            sr: { word: "Pƒçela", dist: ["Pcela", "Pƒáela", "Pƒçel"] }
        },
        // Add many more following this structure...
        
	 // --- ANIMALS ---
	{
	    emoji: "üê∂",
	    en: { word: "Dog", dist: ["Dogg", "Dogge", "Doog"] },
	    de: { word: "Hund", dist: ["Hunt", "Hunnd", "Hunde"] },
	    sr: { word: "Pas", dist: ["Pass", "Pasa", "Paz"] }
	},
	{
	    emoji: "üêò",
	    en: { word: "Elephant", dist: ["Elefant", "Elefent", "Ellephant"] },
	    de: { word: "Elefant", dist: ["Ellefant", "Elefandt", "Elefanth"] },
	    sr: { word: "Slon", dist: ["Sllon", "Slonn", "Slone"] }
	},
	{
	    emoji: "ü¶Å",
	    en: { word: "Lion", dist: ["Lyon", "Lian", "Liion"] },
	    de: { word: "L√∂we", dist: ["Lowe", "L√∂ve", "L√∂be"] },
	    sr: { word: "Lav", dist: ["Laf", "Lava", "Lave"] }
	},
	{
	    emoji: "ü¶í",
	    en: { word: "Giraffe", dist: ["Girafe", "Giraf", "Geraffe"] },
	    de: { word: "Giraffe", dist: ["Girafe", "Schirafe", "Giraffe"] },
	    sr: { word: "≈Ωirafa", dist: ["Zirafa", "≈Ωivafa", "≈Ωirava"] }
	},
	{
	    emoji: "üêí",
	    en: { word: "Monkey", dist: ["Monky", "Munkey", "Monkie"] },
	    de: { word: "Affe", dist: ["Afe", "Afffe", "Affen"] },
	    sr: { word: "Majmun", dist: ["Maimun", "Majmuna", "Marmun"] }
	},
	{
	    emoji: "üêß",
	    en: { word: "Penguin", dist: ["Pinguin", "Pengwin", "Penguinne"] },
	    de: { word: "Pinguin", dist: ["Pingwin", "Pinguinn", "Pingun"] },
	    sr: { word: "Pingvin", dist: ["Pingwin", "Pinvin", "Pigvin"] }
	},
	{
	    emoji: "ü¶ì",
	    en: { word: "Zebra", dist: ["Zibra", "Zebbra", "Zebre"] },
	    de: { word: "Zebra", dist: ["Zebbra", "Sebran", "Zebre"] },
	    sr: { word: "Zebra", dist: ["Zevra", "Sebra", "Cebra"] }
	},
	{
	    emoji: "üêú",
	    en: { word: "Ant", dist: ["Annt", "And", "Ante"] },
	    de: { word: "Ameise", dist: ["Ameyse", "Ameize", "Amise"] },
	    sr: { word: "Mrav", dist: ["Mraf", "Mrau", "Mvav"] }
	},
	{
	    emoji: "ü¶ã",
	    en: { word: "Butterfly", dist: ["Buterfly", "Butterfliy", "Buterfliy"] },
	    de: { word: "Falter", dist: ["Valter", "Fallter", "Faltre"] },
	    sr: { word: "Leptir", dist: ["Lepptir", "Leptiri", "Leptit"] }
	},
	{
	    emoji: "üê™",
	    en: { word: "Camel", dist: ["Cammel", "Camal", "Kamel"] },
	    de: { word: "Kamel", dist: ["Camel", "Kammeel", "Kamell"] },
	    sr: { word: "Kamila", dist: ["Kobila", "Kanila", "Kamilica"] }
	},
	{
	    emoji: "üêÑ",
	    en: { word: "Cow", dist: ["Kow", "Cowe", "Coow"] },
	    de: { word: "Kuh", dist: ["Ku", "Kue", "Kuhh"] },
	    sr: { word: "Krava", dist: ["Kraua", "Kava", "Kravu"] }
	},
	{
	    emoji: "üêä",
	    en: { word: "Crocodile", dist: ["Crocadile", "Crokodile", "Crocodyle"] },
	    de: { word: "Krokodil", dist: ["Crokodil", "Krokodyl", "Krokkodil"] },
	    sr: { word: "Krokodil", dist: ["Crocodil", "Krokodli", "Krotodle"] }
	},
	{
	    emoji: "ü¶å",
	    en: { word: "Deer", dist: ["Deere", "Dear", "Dere"] },
	    de: { word: "Hirsch", dist: ["Hirch", "Hirsh", "Hiersch"] },
	    sr: { word: "Jelen", dist: ["Jellen", "Jelene", "Ielen"] }
	},
	{
	    emoji: "üê¨",
	    en: { word: "Dolphin", dist: ["Dolfin", "Dollphin", "Dolphine"] },
	    de: { word: "Delfin", dist: ["Delphin", "Delfinn", "Delffin"] },
	    sr: { word: "Delfin", dist: ["Delphin", "Defin", "Delfine"] }
	},
	{
	    emoji: "ü¶Ü",
	    en: { word: "Duck", dist: ["Duk", "Ducke", "Dack"] },
	    de: { word: "Ente", dist: ["Ende", "Entte", "Enten"] },
	    sr: { word: "Patka", dist: ["Patcka", "Pata", "Packa"] }
	},
	{
	    emoji: "üê∏",
	    en: { word: "Frog", dist: ["Frogg", "Frogge", "Froog"] },
	    de: { word: "Frosch", dist: ["Froch", "Frosh", "Frosche"] },
	    sr: { word: "≈Ωaba", dist: ["Zaba", "≈Ωabba", "≈Ωava"] }
	},
	{
	    emoji: "üêê",
	    en: { word: "Goat", dist: ["Gote", "Goate", "Goot"] },
	    de: { word: "Ziege", dist: ["Zige", "Ziegge", "Zigen"] },
	    sr: { word: "Koza", dist: ["Kosa", "Kozza", "Koze"] }
	},
	{
	    emoji: "üêé",
	    en: { word: "Horse", dist: ["Hors", "Horrs", "Hourse"] },
	    de: { word: "Pferd", dist: ["Pfert", "Pferdt", "Ferd"] },
	    sr: { word: "Konj", dist: ["Kon", "Konjetina", "Konnj"] }
	},
	{
	    emoji: "ü¶ò",
	    en: { word: "Kangaroo", dist: ["Kangaru", "Kangaro", "Kangarooo"] },
	    de: { word: "K√§nguru", dist: ["Kanguru", "K√§nguruh", "Kenguru"] },
	    sr: { word: "Kengur", dist: ["Kangur", "Kenguru", "Kenguri"] }
	},
	{
	    emoji: "ü¶â",
	    en: { word: "Owl", dist: ["Owle", "Oul", "Owll"] },
	    de: { word: "Eule", dist: ["Oile", "Eulle", "Eulen"] },
	    sr: { word: "Sova", dist: ["Sofa", "Soua", "Sove"] }
	},
	{
	    emoji: "üê∑",
	    en: { word: "Pig", dist: ["Pigg", "Pige", "Piig"] },
	    de: { word: "Schwein", dist: ["Schwine", "Shwein", "Schweinn"] },
	    sr: { word: "Svinja", dist: ["Svinia", "Svinjsko", "Svinjetina"] }
	},
	{
	    emoji: "ü¶à",
	    en: { word: "Shark", dist: ["Sharkk", "Sharc", "Sherk"] },
	    de: { word: "Hai", dist: ["Hay", "Haii", "Haie"] },
	    sr: { word: "Ajkula", dist: ["Aicula", "Ajkulla", "Aikula"] }
	},
	{
	    emoji: "üêö",
	    en: { word: "Snail", dist: ["Snale", "Snayl", "Snaill"] },
	    de: { word: "Schnecke", dist: ["Schneke", "Shnecke", "Schneckke"] },
	    sr: { word: "Pu≈æ", dist: ["Puz", "Pu≈æmu≈æ", "Pu≈æe"] }
	},
	{
	    emoji: "üêç",
	    en: { word: "Snake", dist: ["Snak", "Snayke", "Snaake"] },
	    de: { word: "Schlange", dist: ["Shlange", "Schlanke", "Schlangen"] },
	    sr: { word: "Zmija", dist: ["Zmia", "Zmiija", "Zmija"] }
	},
	{
	    emoji: "üê¢",
	    en: { word: "Turtle", dist: ["Turtel", "Tertle", "Turttle"] },
	    de: { word: "Schildkr√∂te", dist: ["Schildkrote", "Schiltkr√∂te", "Schildkr√∂tte"] },
	    sr: { word: "Kornjaƒça", dist: ["Kornjaca", "Kornjaƒça", "Korniaca"] }
	},
	{
	    emoji: "üêã",
	    en: { word: "Whale", dist: ["Wale", "Whayle", "Whall"] },
	    de: { word: "Wal", dist: ["Wahl", "Wall", "Wale"] },
	    sr: { word: "Kit", dist: ["Hit", "Kite", "Kyt"] }
	},
	{
	    emoji: "üê∫",
	    en: { word: "Wolf", dist: ["Wolfe", "Wulf", "Woolf"] },
	    de: { word: "Wolf", dist: ["Wolff", "Wulf", "Wolfe"] },
	    sr: { word: "Vuk", dist: ["Vuuk", "Vik", "Vukodlak"] }
	},

	// --- FRUITS & VEGETABLES ---
	{
	    emoji: "ü•¶",
	    en: { word: "Broccoli", dist: ["Brocoli", "Broccolli", "Brocolli"] },
	    de: { word: "Brokkoli", dist: ["Brokoli", "Brokkolli", "Brokoli"] },
	    sr: { word: "Brokoli", dist: ["Brokkoli", "Brokoli", "Broccoli"] }
	},
	{
	    emoji: "üåΩ",
	    en: { word: "Corn", dist: ["Corne", "Korn", "Coorn"] },
	    de: { word: "Mais", dist: ["Meis", "Maiz", "Mayse"] },
	    sr: { word: "Kukuruz", dist: ["Kukurus", "Kukuruzz", "Kukuruze"] }
	},
	{
	    emoji: "üçã",
	    en: { word: "Lemon", dist: ["Leman", "Lemmon", "Lemone"] },
	    de: { word: "Zitrone", dist: ["Sitrone", "Zitronne", "Zittrone"] },
	    sr: { word: "Limun", dist: ["Lihmum", "Lihmun", "Limhun"] }
	},
	{
	    emoji: "üßÖ",
	    en: { word: "Onion", dist: ["Onyan", "Onyon", "Onnion"] },
	    de: { word: "Zwiebel", dist: ["Zwiibel", "Swiebel", "Zwiebell"] },
	    sr: { word: "Luk", dist: ["Luh", "Luc", "Ljuk"] }
	},
	{
	    emoji: "üçì",
	    en: { word: "Strawberry", dist: ["Strawbery", "Strawberrie", "Stroberry"] },
	    de: { word: "Erdbeere", dist: ["Erdbeere", "Ertbeere", "Erdberre"] },
	    sr: { word: "Jagoda", dist: ["Jahoda", "Jagota", "Jagode"] }
	},
	{
	    emoji: "üçÖ",
	    en: { word: "Tomato", dist: ["Tomatoe", "Tomatto", "Tomate"] },
	    de: { word: "Tomate", dist: ["Tomatte", "Domate", "Tomaten"] },
	    sr: { word: "Paradajz", dist: ["Paradaiz", "Paradais", "Paradajs"] }
	},
	{
	    emoji: "üçâ",
	    en: { word: "Watermelon", dist: ["Watermellon", "Watermelon", "Watermellon"] },
	    de: { word: "Melone", dist: ["Mellone", "Melonne", "Melonen"] },
	    sr: { word: "Lubenica", dist: ["Lubennica", "Lubenisa", "Lubeniza"] }
	},
	{
	    emoji: "ü•î",
	    en: { word: "Potato", dist: ["Potatoe", "Potatto", "Potatow"] },
	    de: { word: "Kartoffel", dist: ["Kartofel", "Kartofell", "Cartoffel"] },
	    sr: { word: "Krompir", dist: ["Kromppir", "Krompir", "Kpompip"] }
	},
	{
	    emoji: "ü•ë",
	    en: { word: "Avocado", dist: ["Avocada", "Avokado", "Avocaddo"] },
	    de: { word: "Avocado", dist: ["Avocada", "Avokado", "Avocaddo"] },
	    sr: { word: "Avokado", dist: ["Avocado", "Avocaddo", "Abokado"] }
	},
	{
	    emoji: "ü´ê",
	    en: { word: "Blueberry", dist: ["Bluberry", "Blueberrie", "Bluberry"] },
	    de: { word: "Blaubeere", dist: ["Blaubere", "Blauberre", "Glaubere"] },
	    sr: { word: "Borovnica", dist: ["Borovnica", "Borovnicca", "Borovniza"] }
	},
	{
	    emoji: "ü•ï",
	    en: { word: "Carrot", dist: ["Carot", "Carrott", "Karrot"] },
	    de: { word: "Karotte", dist: ["Karote", "Carotte", "Karrotte"] },
	    sr: { word: "≈†argarepa", dist: ["Sargarepa", "≈†argarera", "≈†argapera"] }
	},
	{
	    emoji: "ü•í",
	    en: { word: "Cucumber", dist: ["Cucamber", "Cukumber", "Cuccumber"] },
	    de: { word: "Gurke", dist: ["Gurrke", "Curke", "Gurken"] },
	    sr: { word: "Krastavac", dist: ["Krastavaz", "Kpactabac", "Krastavica"] }
	},
	{
	    emoji: "üçÜ",
	    en: { word: "Eggplant", dist: ["Egplant", "Eggplante", "Egplante"] },
	    de: { word: "Aubergine", dist: ["Auberchiene", "Oberjine", "Aubergene"] },
	    sr: { word: "Patlid≈æan", dist: ["Patlidzan", "Patliƒëan", "Ratlid≈æan"] }
	},
	{
	    emoji: "ü•ù",
	    en: { word: "Kiwi", dist: ["Kivi", "Kiewi", "Kiwie"] },
	    de: { word: "Kiwi", dist: ["Kiewi", "Kivi", "Kiwie"] },
	    sr: { word: "Kivi", dist: ["Kiwi", "Kivvi", "Kibi"] }
	},
	{
	    emoji: "ü•≠",
	    en: { word: "Mango", dist: ["Mano", "Mangoe", "Manggo"] },
	    de: { word: "Mango", dist: ["Mano", "Manggo", "Mangos"] },
	    sr: { word: "Mango", dist: ["Mano", "Mahgo", "Mangou"] }
	},
	{
	    emoji: "üçÑ",
	    en: { word: "Mushroom", dist: ["Mushrom", "Musheroom", "Musshroom"] },
	    de: { word: "Pilz", dist: ["Pils", "Pilss", "Pilze"] },
	    sr: { word: "Peƒçurka", dist: ["Pecurka", "Peƒáurka", "Peƒçurka"] }
	},
	{
	    emoji: "üçä",
	    en: { word: "Orange", dist: ["Oranje", "Orenge", "Orrange"] },
	    de: { word: "Orange", dist: ["Oranche", "Orrange", "Orangen"] },
	    sr: { word: "Pomorand≈æa", dist: ["Pomorandza", "Pomoranƒëa", "Pomorandja"] }
	},
	{
	    emoji: "üçë",
	    en: { word: "Peach", dist: ["Peache", "Peech", "Peche"] },
	    de: { word: "Pfirsich", dist: ["Pfirsih", "Pfirshich", "Firsich"] },
	    sr: { word: "Breskva", dist: ["Breskva", "Breksva", "Breckva"] }
	},
	{
	    emoji: "üçç",
	    en: { word: "Pineapple", dist: ["Pinapple", "Pineappel", "Pynapple"] },
	    de: { word: "Ananas", dist: ["Annanas", "Ananass", "Ananaz"] },
	    sr: { word: "Ananas", dist: ["Annanas", "Anananas", "Ananac"] }
	},
	{
	    emoji: "üéÉ",
	    en: { word: "Pumpkin", dist: ["Pumkin", "Pumpkine", "Pumkin"] },
	    de: { word: "K√ºrbis", dist: ["Kurbis", "K√ºrbi√ü", "K√ºrbiss"] },
	    sr: { word: "Bundeva", dist: ["Bundeva", "Bundevva", "Bundefe"] }
	},
	{
	    emoji: "ü•¨",
	    en: { word: "Salad", dist: ["Sallad", "Salade", "Salat"] },
	    de: { word: "Salat", dist: ["Sallat", "Salade", "Salate"] },
	    sr: { word: "Salata", dist: ["Satala", "Calata", "Salat"] }
	},

	// --- OBJECTS & NATURE ---
	{
	    emoji: "üéà",
	    en: { word: "Balloon", dist: ["Baloon", "Ballon", "Ballun"] },
	    de: { word: "Ballon", dist: ["Balon", "Ballonn", "Ballone"] },
	    sr: { word: "Balon", dist: ["Balkon", "Balonn", "Balone"] }
	},
	{
	    emoji: "üö≤",
	    en: { word: "Bicycle", dist: ["Bycycle", "Bicicle", "Bicykle"] },
	    de: { word: "Fahrrad", dist: ["Farad", "Farrad", "Fahrrat"] },
	    sr: { word: "Bicikl", dist: ["Bicikla", "Bicikll", "Bizikl"] }
	},
	{
	    emoji: "üìñ",
	    en: { word: "Book", dist: ["Boke", "Booke", "Boock"] },
	    de: { word: "Buch", dist: ["Buh", "Buhch", "Buche"] },
	    sr: { word: "Knjiga", dist: ["Kniga", "Kljiga", "Knjige"] }
	},
	{
	    emoji: "üöå",
	    en: { word: "Bus", dist: ["Buss", "Buse", "Buus"] },
	    de: { word: "Bus", dist: ["Buss", "Buse", "Busse"] },
	    sr: { word: "Autobus", dist: ["Autobuc", "Autobuss", "Autobuz"] }
	},
	{
	    emoji: "üöó",
	    en: { word: "Car", dist: ["Carr", "Care", "Caa"] },
	    de: { word: "Auto", dist: ["Autto", "Autos", "Audto"] },
	    sr: { word: "Auto", dist: ["Autto", "Autos", "Audto"] }
	},
	{
	    emoji: "‚òÅÔ∏è",
	    en: { word: "Cloud", dist: ["Clowd", "Cloude", "Claud"] },
	    de: { word: "Wolke", dist: ["Wolcke", "Wollke", "Wolken"] },
	    sr: { word: "Oblak", dist: ["Olblak", "Oblakk", "Oblake"] }
	},
	{
	    emoji: "üå∏",
	    en: { word: "Flower", dist: ["Flowar", "Flowre", "Flour"] },
	    de: { word: "Blume", dist: ["Blumme", "Bluhme", "Blumen"] },
	    sr: { word: "Cvet", dist: ["Cvet", "Zvet", "Cvett"] }
	},
	{
	    emoji: "üé©",
	    en: { word: "Hat", dist: ["Hatt", "Hate", "Haat"] },
	    de: { word: "Hut", dist: ["Hutt", "Hute", "Huut"] },
	    sr: { word: "≈†e≈°ir", dist: ["Sesir", "≈†esir", "≈†e≈°irr"] }
	},
	{
	    emoji: "üîë",
	    en: { word: "Key", dist: ["Kee", "Keye", "Keey"] },
	    de: { word: "Schl√ºssel", dist: ["Schlusel", "Shl√ºssel", "Schl√ºsel"] },
	    sr: { word: "Kljuƒç", dist: ["Kluƒç", "Kljuch", "Kljuƒá"] }
	},
	{
	    emoji: "üåô",
	    en: { word: "Moon", dist: ["Moone", "Mone", "Moone"] },
	    de: { word: "Mond", dist: ["Mont", "Monnd", "Monde"] },
	    sr: { word: "Mesec", dist: ["Mesec", "Mesez", "Mecec"] }
	},
	{
	    emoji: "üåà",
	    en: { word: "Rainbow", dist: ["Rainbo", "Rainbbow", "Raynbow"] },
	    de: { word: "Regenbogen", dist: ["Regnbogen", "Regebogen", "Regenbogn"] },
	    sr: { word: "Duga", dist: ["Dugga", "Duka", "Duuga"] }
	},
	{
	    emoji: "üöÄ",
	    en: { word: "Rocket", dist: ["Roket", "Rockit", "Rokketi"] },
	    de: { word: "Rakete", dist: ["Rackete", "Rakette", "Raketen"] },
	    sr: { word: "Raketa", dist: ["Rakketa", "Paketa", "Rakete"] }
	},
	{
	    emoji: "üö¢",
	    en: { word: "Ship", dist: ["Shipp", "Shipe", "Schip"] },
	    de: { word: "Schiff", dist: ["Schif", "Shiff", "Schiffe"] },
	    sr: { word: "Brod", dist: ["Brodd", "Brot", "Brode"] }
	},
	{
	    emoji: "üåü",
	    en: { word: "Star", dist: ["Starr", "Stare", "Staar"] },
	    de: { word: "Stern", dist: ["St√§rn", "Sterren", "Sterne"] },
	    sr: { word: "Zvezda", dist: ["Zveda", "Zviezda", "Zvesda"] }
	}
    ];

    let availableIndices = []; // To track words not yet used in this round

    let currentLanguage = 'en';
    let currentStep = 0;
    const totalSteps = 8;

	let mistakeCount = 0;
	let missedWords = []; // Stores { emoji: "üçé", word: "Apple" }
	
	const uiText = {
	    en: { perfect: "Perfect! No mistakes!", practice: "Good practice! Remember these words:", playAgain: "Play Again" },
	    de: { perfect: "Perfekt! Keine Fehler!", practice: "Gut ge√ºbt! Merke dir diese W√∂rter:", playAgain: "Nochmal spielen" },
	    sr: { perfect: "Savr≈°eno! Bez gre≈°aka!", practice: "Odliƒçna ve≈æba! Zapamti ove reƒçi:", playAgain: "Igraj ponovo" }
	};
    
    function refreshAvailableWords() {
        // Fill the array with indices 0, 1, 2, ... gameData.length - 1
        availableIndices = Array.from(gameData.keys());
        // Shuffle the indices so the order is random
        availableIndices.sort(() => Math.random() - 0.5);
    }

	function setLang(lang) {
	    currentLanguage = lang;
	    document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
	    document.getElementById('btn-' + lang).classList.add('active');
	    
	    // Reset game state on language switch
	    currentStep = 0;
	    mistakeCount = 0;
	    missedWords = [];
	    refreshAvailableWords();
	    updateBee();
	    nextQuestion();
	}

    function toCyrillic(text) {
        const map = {
            'A':'–ê', 'B':'–ë', 'V':'–í', 'G':'–ì', 'D':'–î', 'ƒê':'–Ç', 'E':'–ï', '≈Ω':'–ñ', 'Z':'–ó', 'I':'–ò',
            'J':'–à', 'K':'–ö', 'L':'–õ', 'Lj':'–â', 'M':'–ú', 'N':'–ù', 'Nj':'–ä', 'O':'–û', 'P':'–ü', 'R':'–†',
            'S':'–°', 'T':'–¢', 'ƒÜ':'–ã', 'U':'–£', 'F':'–§', 'H':'–•', 'C':'–¶', 'ƒå':'–ß', 'D≈æ':'–è', '≈†':'–®',
            'a':'–∞', 'b':'–±', 'v':'–≤', 'g':'–≥', 'd':'–¥', 'ƒë':'—í', 'e':'–µ', '≈æ':'–∂', 'z':'–∑', 'i':'–∏',
            'j':'—ò', 'k':'–∫', 'l':'–ª', 'lj':'—ô', 'm':'–º', 'n':'–Ω', 'nj':'—ö', 'o':'–æ', 'p':'–ø', 'r':'—Ä',
            's':'—Å', 't':'—Ç', 'ƒá':'—õ', 'u':'—É', 'f':'—Ñ', 'h':'—Ö', 'c':'—Ü', 'ƒç':'—á', 'd≈æ':'—ü', '≈°':'—à'
        };
        let result = text.replace(/Nj|Lj|D≈æ|nj|lj|d≈æ/g, m => map[m]);
        return result.split('').map(char => map[char] || char).join('');
    }

    function nextQuestion() {
        // 1. Refill the list if it's empty
        if (availableIndices.length === 0) {
            refreshAvailableWords();
        }

        let item;
        let correctWord;
         let indexInAvailable;

        // 2. Find a word that fits the length/language criteria from the available list 
        for (let i = 0; i < availableIndices.length; i++) {
            const testIndex = availableIndices[i];
            const testItem = gameData[testIndex];
         
            const langKey = currentLanguage === 'sr-cyr' ? 'sr' : currentLanguage;
            let baseWord = testItem[langKey].word;
            let wordToTest = currentLanguage === 'sr-cyr' ? toCyrillic(baseWord) : baseWord;

            // Note: You mentioned you want to allow long words now, 
            // but I'll keep the logic here in case you want to filter anything else.
            item = testItem;
            correctWord = wordToTest;
            indexInAvailable = i;
            break; 
        }

        // 3. Remove the chosen index so it's not used again this round
        availableIndices.splice(indexInAvailable, 1);
    
        document.getElementById('image-display').innerText = item.emoji;

        const langKey = currentLanguage === 'sr-cyr' ? 'sr' : currentLanguage;
        const correctRaw = item[langKey].word;
        const correct = currentLanguage === 'sr-cyr' ? toCyrillic(correctRaw) : correctRaw;
        
        // Randomly pick 2 distractors from the list
        let distractorsRaw = [...item[langKey].dist].sort(() => 0.5 - Math.random()).slice(0, 2);
        let options = [correct];
        distractorsRaw.forEach(d => {
            options.push(currentLanguage === 'sr-cyr' ? toCyrillic(d) : d);
        });

        options.sort(() => Math.random() - 0.5);

        const container = document.getElementById('options-container');
        container.innerHTML = '';
        
        options.forEach(word => {
            const btn = document.createElement('button');
            btn.className = 'word-btn';
            
            // Highlight first letter
            const first = word.charAt(0).toUpperCase();
            const rest = word.slice(1);
            btn.innerHTML = `<span class="first-letter">${first}</span>${rest}`;
            
            btn.onclick = () => checkAnswer(btn, word === correct);
            container.appendChild(btn);
        });
    }

	function checkAnswer(btn, isCorrect) {
	    const currentEmoji = document.getElementById('image-display').innerText;
	    const currentCorrectWord = btn.parentElement.dataset.correct; // We'll store this in the container
	
	    if (isCorrect) {
	        btn.classList.add('correct');
	        currentStep++;
	        updateBee();
	        
	        if (currentStep >= totalSteps) {
	            setTimeout(showCelebration, 600);
	        } else {
	            setTimeout(nextQuestion, 1000);
	        }
	    } else {
	        if (!btn.classList.contains('wrong')) { // Only count the first time they miss THIS word
	            mistakeCount++;
	            // Store the emoji and the correct spelling for the summary
	            if (!missedWords.some(m => m.emoji === currentEmoji)) {
	                missedWords.push({ emoji: currentEmoji, word: currentCorrectWord });
	            }
	        }
	        btn.classList.add('wrong');
	        btn.style.animation = "shake 0.3s";
	        setTimeout(() => btn.style.animation = "", 300);
	    }
	}
	
	function showCelebration() {
	    const overlay = document.getElementById('celebration-overlay');
	    const langKey = currentLanguage.startsWith('sr') ? 'sr' : currentLanguage;
	    let baseMsg = uiText[langKey];
	    
	    // Convert messages to Cyrillic if needed
	    let title = (currentLanguage === 'sr-cyr') ? toCyrillic(mistakeCount === 0 ? baseMsg.perfect : baseMsg.practice) : (mistakeCount === 0 ? baseMsg.perfect : baseMsg.practice);
	    let btnText = (currentLanguage === 'sr-cyr') ? toCyrillic(baseMsg.playAgain) : baseMsg.playAgain;
	
	    let contentHTML = `<h1 style="color: #fbc02d;">${mistakeCount === 0 ? 'üèÜ' : 'üêù'}</h1>`;
	    contentHTML += `<h2>${title}</h2>`;
	
	    if (mistakeCount > 0) {
	        contentHTML += `<div style="margin: 20px; display: flex; flex-wrap: wrap; justify-content: center; gap: 15px;">`;
	        missedWords.forEach(m => {
	            contentHTML += `
	                <div style="background: #fff9c4; padding: 10px; border-radius: 15px; border: 2px solid #ffd700;">
	                    <span style="font-size: 1.5rem;">${m.emoji}</span>
	                    <b style="font-size: 1.2rem; margin-left: 5px;">${m.word}</b>
	                </div>`;
	        });
	        contentHTML += `</div>`;
	    }
	
	    contentHTML += `<button onclick="resetGame()" style="font-size: 1.5rem; padding: 15px 40px; border-radius: 30px; background: #333; color: #ffd700; border: none; cursor: pointer; font-weight: bold;">${btnText}</button>`;
	    
	    overlay.innerHTML = contentHTML;
	    overlay.style.display = 'flex';
	}
	
	function updateBee() {
	    const trail = document.getElementById('trail-container');
	    const bee = document.getElementById('bee');
	    const width = trail.offsetWidth - 100;
	    const progress = (currentStep / totalSteps) * width;
	    
	    const xPos = progress;
	    const yPos = (Math.sin(currentStep) * 10); // Subtle wave movement
	    
	    // scaleX(-1) keeps the bee facing the honey pot (right)
	    bee.style.transform = `translate(${xPos}px, ${yPos}px) scaleX(-1)`;
	}

    function resetGame() {
        currentStep = 0;
        refreshAvailableWords(); // Start with a fresh list of words
        updateBee();
        document.getElementById('celebration-overlay').style.display = 'none';
        nextQuestion();
    }
 
    // Initial Start
    refreshAvailableWords();
    document.getElementById('btn-' + currentLanguage).classList.add('active');
    updateBee();
    nextQuestion();
    window.onresize = updateBee;
</script>

<style>
    @keyframes shake {
        0% { transform: translateX(0); }
        25% { transform: translateX(-10px); }
        50% { transform: translateX(10px); }
        75% { transform: translateX(-10px); }
        100% { transform: translateX(0); }
    }
</style>

</body>
</html>
